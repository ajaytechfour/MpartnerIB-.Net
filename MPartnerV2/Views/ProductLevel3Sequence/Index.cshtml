@model Luminous.EF.ProductLevelThree
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="@Url.Content("~/assets/css/Formstyle.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/assets/js/jquery-1.10.2.js")" type="text/javascript"></script>
<script src="@Url.Content("~/assets/js/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.js"></script>


<style type="text/css">
    section#main_content {
        min-height: 1260px;
    }

    .required {
        color: Red;
    }

    table {
        border: 0;
        border-spacing: 0;
        font-size: 0.857em;
        margin: 10px 0;
        width: 100%;
    }

        table table {
            font-size: 1em;
        }

    #footer-wrapper table {
        font-size: 1em;
    }

    table tr th {
        background: #757575;
        background: rgba(0, 0, 0, 0.51);
        border-bottom-style: none;
    }

        table tr th, table tr th a, table tr th a:hover {
            color: #FFF;
            font-weight: bold;
        }

    table tbody tr th {
        vertical-align: top;
    }

    tr td, tr th {
        padding: 4px 9px;
        border: 1px solid #fff;
        text-align: left; /* LTR */
    }

    #footer-wrapper tr td, #footer-wrapper tr th {
        border-color: #555;
        border-color: rgba(255, 255, 255, 0.18);
    }

    tr.odd {
        background: #e4e4e4;
        background: rgba(0, 0, 0, 0.105);
    }

    tr, tr.even {
        background: #efefef;
        background: rgba(0, 0, 0, 0.063);
    }

    table ul.links {
        margin: 0;
        padding: 0;
        font-size: 1em;
    }

        table ul.links li {
            padding: 0 1em 0 0;
        }
</style>
<style>
    .FullDes {
        position: relative;
        background-color: #1D1D1D;
        width: 245px;
        color: white;
        border: 1px solid black;
        display: none;
    }
</style>

@*Setting Of ValidationMessage*@

<script type="text/javascript">



    $(function () {
        $.post("@Url.Content("~/ProductCategory/GetParentCategory")", null, function (data) { SetParentCategory(data); }, "Json");
      
        @*$.post("@Url.Content("~/ProductLevelOne/GetProductCategory")", null, function (data) { SetProdcutCategoryPC(data, 'ProductCategory'); },
        "Json");*@
        @*$.post("@Url.Content("~/ProductLevel3/GetContactDetail")", null, function (data) { SetGrid(data); }, "Json");*@

       
    });
   

  

    //Fill Grid View Table Begin

 
    function SetGrid(data) {
        if (data == "Login") {
            location.href = "@Url.Content("~/Logout/Logout")";
        }
        else if (data == "snotallowed") {
            location.href = "@Url.Content("~/snotallowed/snotallowed")";
        }
        else {
            var body = "";
            $("#Grid tbody").empty();
            $.each(data.result, function (key, value) {

                //var Description = value.Descriptions.toString();
                //if (Description == null || Description == "") {
                //    var shorDescriptions = Description;
                //}
                //else {
                //    var shorDescriptions = Description.substring(0, 10);
                //}

                body += "<tr class=ui-sortable-handle><td> PLT" + value.id + "</td>" +
                     "<td>" + value.Parentcat + "</td>" +
                "<td>" + value.PCat + "</td>" +
                "<td>" + value.proCatOne + "</td>" +
            "<td>" + value.ProCatTwo + "</td>" +
            "<td>" + value.Name + "</td>" +
            "<td>" + value.ProductCode + "</td>" +
            //"<td><div style='Position:absolute;cursor:pointer'> <span class='Des' onmouseout='hideFullDescription(this);' onmouseover='showFullDescription(this);'>" + shorDescriptions + "</span><div style='position:relative;' class='FullDes'>" + Description + "</div></div></td>" +
             "<td>" + value.Rating + "</td>" +
             "<td>" + value.StartDate + "</td>" +
             "<td>" + value.EndDate + "</td>" +
             "<td>" + value.status + "</td></tr>";

            });
            $("#Grid tbody").append(body);

            //$("#Grid tbody tr").draggable({
            //    appendTo: "body",
            //    helper: "clone"
            //});

            //$("#Grid tbody").droppable({
            //    activeClass: "ui-state-default",
            //    hoverClass: "ui-state-hover",
            //    accept: ":not(.ui-sortable-helper)",
            //    drop: function (event, ui) {
            //        $('.placeholder').remove();
            //        row = ui.draggable;
            //        $(this).append(row);
            //    }
            //});
            SetPages(data.TotalRecord);
        }

    }

   





    // SetProductCategory begin
    //    function SetProdcutCategory(data, id) {
    //        if (data == "Login") {
    //            location.href = "@Url.Content("~/Logout/Logout")";
    //        }
    //        else if (data == "snotallowed") {
    //            location.href = "@Url.Content("~/snotallowed/snotallowed")";
    //        }
    //        else {
    //            option = "";
    //            var procat = $("#" + id);
    //            procat.empty();
    //            procat.append("<option value=0>Select</option>");
    //            $.each(data, function (key, value) {
    //                option += "<option value=" + value.id + ">" + value.Name + "</option>";

    //            });
    //            procat.append(option);
    //        }

    //    }
    function SetProdcutCategoryPC(data, id) {
        if (data == "Login") {
            location.href = "@Url.Content("~/Logout/Logout")";
        }
        else if (data == "snotallowed") {
            location.href = "@Url.Content("~/snotallowed/snotallowed")";
        }
        else {
            option = "";
            var procat = $("#" + id);
            procat.empty();
            procat.append("<option value=0>Select</option>");
            $.each(data, function (key, value) {
                option += "<option value=" + value.id + ">" + value.Name + "</option>";

            });
            procat.append(option);
        }

    }
    // SetProduct Category end



    // SetProductCategory begin
    function SetProdcutCategoryLoad(data, id) {
        if (data == "Login") {
            location.href = "@Url.Content("~/Logout/Logout")";
        }
        else if (data == "snotallowed") {
            location.href = "@Url.Content("~/snotallowed/snotallowed")";
        }
        else {
            option = "";
            var procat = $("#" + id);
            procat.empty();
            procat.append("<option value=0>Select</option>");
            $.each(data, function (key, value) {
                option += "<option value=" + value.id + ">" + value.Name + "</option>";

            });
            procat.append(option);
            if ('@ViewBag.ProductCat' != "") {

                $("#ProductCategory").val('@ViewBag.ProductCat');
            }
            if ('@ViewBag.ProductCat1' != "") {
                $("#pclvlOne").val('@ViewBag.ProductCat1');
            }
            if ('@ViewBag.ProductCat2' != "") {
                $("#pclvlTwo").val('@ViewBag.ProductCat2');
            }
            if ('@ViewBag.ProductCat3' != "") {
                $("#pclvlthree").val('@ViewBag.ProductCat3');
            }
        }
    }

    //Set Parent Category//
    function SetParentCategory(data) {
        if (data == "Login") {
            location.href = "@Url.Content("~/Logout/Logout")";
        }
        else if (data == "snotallowed") {
            location.href = "@Url.Content("~/snotallowed/snotallowed")";
        }
        else {
            option = "";
            var procat = $("#ParentCategory");
            procat.empty();
            procat.append("<option value=0>Select</option>");
            $.each(data, function (key, value) {
                option += "<option value=" + value.id + ">" + value.Name + "</option>";

            });
            procat.append(option);
        }
    }


    // SetParent Category end

    function SetProdcutCat() {

        
        var procat = $("#ParentCategory :selected").val();
        var procatLvlOne = $("#pclvlOne");
        $.post("@Url.Content("~/ProductLevelTwoSequence/GetProductCategory")", { procatid: procat }, function (data) { SetProdcutCategory(data); }, "Json");

        
    }



    function SetProdcutlevelOne() {
        var procat = $("#ProductCategory :selected").val();
        var procatLvlOne = $("#pclvlOne");
        $.post("@Url.Content("~/ProductLevelTwo/GetProductLevelOneCategory")", { procatid: procat }, function (data) { SetProdcutCategoryPC(data, 'pclvlOne'); }, "Json");
    }

    function SetProdcutlevelTwo() {
        var procat = $("#ProductCategory :selected").val();
        var procat2 = $("#pclvlOne :selected").val();



        $.post("@Url.Content("~/ProductLevel3/GetProductLevelTwoCategory")", { procatid: procat, procatone: procat2 }, function (data) { SetProdcutCategoryPC(data, 'pclvlTwo'); }, "Json");
    }

    function GetProductLvl3() {
        var procat = $("#ProductCategory :selected").val();
        var prolvl1 = $("#pclvlOne :selected").val();
        var parentcategory = $("#ParentCategory :selected").val();
        var procat3 = $("#pclvlTwo :selected").val();
        $.post("@Url.Content("~/ProductLevel3Sequence/GetContactDetail")", { Prntcategory: parentcategory, productlvl1: prolvl1, procat: procat, ProductLvlthreeId: procat3 }, function (data) { SetGrid(data); }, "Json");

        @*$.post("@Url.Content("~/ProductLevelThree/GetProductLevel3")", { productid: procat, ProductlvlOneid: procat2, ProductLvlTwoId: procat3 }, function (data) { SetProdcutCategoryPC(data, 'pclvlthree'); }, "Json");*@
    }

    function SetPages(paging) {
        var pages = "";
        $("#Paging").empty();
        $("#Paging").empty();

        for (var i = 1; i <= parseInt(paging) ; i++) {

            pages += "<a style='cursor:pointer' onclick=GetPagesValues(" + i + ");> " + i + "  </a>";


        }
        $("#Paging").append("<u> Pages:-</u>" + pages);
    }


    function GetPagesValues(id) {
        $.post("@Url.Content("~/ProductLevel3/GetContactDetail")", { page: id }, function (data) { SetGrid(data); }, "Json");
    }

    //Grid Swapping//
    $(document).ready(function () {
        var coords = new Array();
        $('#Grid tbody').addClass("DragMe");

        $('.DragMe').sortable({
            disabled: false,
            axis: 'y',
            //items: "> tr:not(:first)",
            forceHelperSize: true,
            update: function (event, ui) {
                var Newpos = ui.item.index();

                var RefID = $('tr').find('td:first').html();
                //var RefID=   $(this).closest('tr').attr('id');

                //alert("Position " + Newpos + "..... RefID: " + RefID);
                $("#Grid tr:has(td)").each(function () {

                    var RefID = $(this).find("td:eq(0)").html();
                    var NewPosition = $(".ui-sortable-handle").index(this) + 1;
                    //alert(RefID + " " + NewPosition);
                    coords.push({ x: RefID, y: NewPosition });
                });

                for (var i = 0; i < coords.length; i++) {
                    var xcoord = coords[i].x + "," + coords[i].y;

                    var arr = { ids: xcoord };
                    $.ajax({
                        url: '@Url.Action("UpdateSequence", "ProductLevel3Sequence")',
                        type: 'POST',
                        data: JSON.stringify(arr),
                        contentType: 'application/json; charset=utf-8',
                        dataType: 'json',
                        success: function (msg) {
                            alert(msg);
                        }
                    });
                }

                coords.length = 0;


            }
        }).disableSelection();
    });
    //Grid Swapping End//

</script>

@* Permisson For Script *@
<script type="text/javascript">
    function Allst() {
        if ($("#All").is(":checked")) {
            $("#region").attr("disabled", true);
            $("#destributor").attr("disabled", true);
            $("#Dealer").attr("disabled", true);
            $("#RegionList_chosen").hide();
            $("#DestributorList_chosen").hide();
            $("#DealerList_chosen").hide();
            $("#checkDistri").hide();
            $("#checkDeal").hide();
        }
        else {
            $("#region").attr("disabled", false);
            $("#destributor").attr("disabled", false);
            $("#Dealer").attr("disabled", false);
            $("#RegionList_chosen").show();
            $("#DestributorList_chosen").show();
            $("#DealerList_chosen").show();
            $("#checkDistri").show();
            $("#checkDeal").show();
        }

    }


    function GetRegions() {
        if ($("#region").is(":checked")) {

            $.post("@Url.Content("~/Destributor/GetRegions")", null, function (data) { SetProdcutCategory(data, 'RegionList'); },
                 "Json");
            $("#RegionList_chosen").show();

        }
        else {
            $("#RegionList_chosen").hide();
        }

    }
    function GetDestributor() {
        if ($("#destributor").is(":checked")) {
            if ($("#region").is(":checked")) {
                SetDestributor();

            }
            else {
                $.post("@Url.Content("~/Dealers/GetAllDestributors")", null, function (data) { SetProdcutCategory(data, 'DestributorList'); }, "Json");
            }
            $("#DestributorList_chosen").show();
        }
        else {

            $("#DestributorList_chosen").hide();
        }
    }
    function GetDealer() {
        if ($("#Dealer").is(":checked")) {
            if ($("#destributor").is(":checked")) {
                SetDealer();
            }
            else {

                $.post("@Url.Content("~/Dealers/GetAllDealer")", null, function (data) { SetProdcutCategory(data, 'DealerList'); }, "Json");
            }
            $("#DealerList_chosen").show();
        }
        else {

            $("#DealerList_chosen").hide();
        }
    }
    function SetProdcutCategory(data, id) {
        if (data == "Login") {
            location.href = "@Url.Content("~/Logout/Logout")";
        }
        else if (data == "snotallowed") {
            location.href = "@Url.Content("~/snotallowed/snotallowed")";
        }
        else {
            //option = "";
            //var procat = $("#" + id);
            //procat.empty();
            option = "";
            var procat = $("#ProductCategory");
            procat.empty();
            procat.append("<option value=0>Select</option>");
            $.each(data, function (key, value) {
                option += "<option value=" + value.id + ">" + value.Name + "</option>";

            });
            procat.append(option);
           
        }

    }

    function SetRegion() {
        $("#RgList").val($("#RegionList").val());
        var regionlist = $("#RgList").val();

        $.post("@Url.Content("~/Dealers/GetDestributorsByMultiPleids")", { RegionId: regionlist }, function (data) { SetProdcutCategory(data, 'DestributorList'); }, "Json");
    }
    function SetDestributor() {
        $("#disList").val($("#DestributorList").val());

        var regionlist = $("#disList").val();

        $.post("@Url.Content("~/Dealers/GetAllDealerByMultiPleIds")", { RegionId: regionlist }, function (data) { SetProdcutCategory(data, 'DealerList'); }, "Json");
    }
    function SetDealer() {
        $("#Dealist").val($("#DealerList").val());
    }

    function a() {
        $("#forms").submit();
    }
</script>


@* End Permisson For *@
<div id="form" style="margin-bottom: 11px">
    @using (Html.BeginForm("SaveContact", "ProductLevel3", FormMethod.Post, new { enctype = "multipart/form-data", @id = "forms" }))
    {
        @Html.AntiForgeryToken()
        <div id="content_wrap">
            <div class="msgbar msg_Info heading">
                Product Level Three
            </div>
            <div class="content_main">
                <div class="boxes1">
                    <table id="GridView">
                        <tr>
                            <td style="width: 137px;">
                                Parent Category <span class="required">*</span>
                            </td>
                            <td style="width: 221px">
                                <select name="ParentCatid" onchange="SetProdcutCat();" style="color: black" id="ParentCategory">
                                    <option>Select</option>
                                </select>
                                <br />
                                @Html.ValidationMessageFor(model => model.ParentCatid, "", new { @class = "required" })
                            </td>
                            <td style="width: 137px;">
                                Product Category <span class="required">*</span>
                            </td>
                            <td style="width: 221px">

                                <select name="pcId" onchange="SetProdcutlevelOne();" style="color: black" id="ProductCategory">
                                    <option value="0">Select</option>
                                </select>
                                <br />
                                @Html.ValidationMessageFor(model => model.productCategoryid, "", new { @class = "required" })
                                <span id="pcIdValidation"></span>
                            </td>

                        </tr>
                        <tr>
                            <td style="width: 124px;">
                                Product Level One<span class="required">*</span>
                            </td>
                            <td style="width: 221px">
                                <select name="ProductCat1" onchange="SetProdcutlevelTwo();" style="color: black"
                                        id="pclvlOne">
                                    <option value="0">Select</option>
                                </select>
                                <br />
                                @Html.ValidationMessageFor(model => model.ProductLevelOne, "", new { @class = "required" })
                            </td>
                            <td style="width: 124px;">
                                Product Level Two<span class="required">*</span>
                            </td>
                            <td style="width: 221px">
                                <select name="ProductCat2" onchange="GetProductLvl3()" style="color: black" id="pclvlTwo">
                                    <option value="0">Select</option>
                                </select>
                                <br />
                                @Html.ValidationMessageFor(model => model.ProductLevelTwo, "", new { @class = "required" })
                            </td>

                        </tr>
                        <tr></tr>

                    </table>
                 
                </div>
            </div>
        </div>

    }
   
</div>
<div id="list" style="width: 997px; float: right; margin-right: 15px;">
    <table id="Grid" width="100%">
        <thead>
            <tr>
                <th>
                    ID
                </th>
                <th>
                    Parent Category
                </th>
                <th>
                    Product Category
                </th>
                <th>
                    Product Level One
                </th>
                <th>
                    Product Level Two
                </th>
                <th>
                    Product Level Three
                </th>
                <th>
                    Product Code
                </th>
                @*<th>
                        Descriptions
                    </th>*@
                <th>
                    Rating
                </th>
                <th>
                    Start Date
                </th>
                <th>
                    End Date
                </th>
                <th>
                    Status
                </th>
             
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <div id="Paging">
    </div>
    <div style="float:right">
        @if (Session["Search"] != null)
        {
            @Html.ActionLink("Back", "Index")
        }
    </div>

</div>