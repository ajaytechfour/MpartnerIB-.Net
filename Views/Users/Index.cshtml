@model Luminous.EF.UsersList
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" href=@Url.Content("~/css/maincp.css")" />
<link rel="stylesheet" href="@Url.Content("~/css/resetcp.css")" />
<script src="@Url.Content("~/Scripts/jquery-1.7.1.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/city.js")" type="text/javascript"></script>
<link href="@Url.Content("~/assets/css/Tables.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/assets/css/Formstyle.css")" rel="stylesheet" type="text/css" />
<script type="text/javascript">
    $(function () {
        $.post("@Url.Content("~/Users/GetUsersDetail")", null, function (data) { SetGrid(data); }, "Json");
        show();
        $.get("@Url.Content("~/Users/GetRole")", { }, function (data) { chk(data, "RoleID"); });
    });


    //setGrid
    function SetGrid(data) {
        if (data == "Login") {
            location.href = "@Url.Content("~/Logout/Logout")";
        }
        else if (data == "snotallowed") {
            location.href = "@Url.Content("~/snotallowed/snotallowed")";
        }
        else {
            var body = "";
            $("#Grid tbody").empty();
            $.each(data.result, function (key, value) {
                body += "<tr><td>" + value.id + "</td>" +
            "<td>" + value.name + "</td>" +
             "<td>" + value.sapcode + "</td>" +
            "<td>" + value.CustomerType + "</td>" +
             "<td>" + value.status + "</td>" +

            "<td><a style='cursor:pointer' onclick=Edit(" + value.id + ");>Edit</a> <a style='cursor:pointer' onclick=Delete(" + value.id + ");>Delete</a>"
+

            " <a style='cursor:pointer' onclick=Detail(" + value.id + ");>Detail</a> </td></tr>";
                debugger;
            });
            $("#Grid tbody").append(body);
            SetPages(data.TotalRecord);
        }
    }
    //setGrid

    //GetDetail
    function Detail(id) {
        location.href = "@Url.Content("~/Users/Details/")"+id;
    }
    //GetDetail
    //set Page
    function SetPages(paging) {
        var pages = "";
        $("#Paging").empty();
        $("#Paging").empty();

        for (var i = 1; i <= parseInt(paging); i++) {

            pages += "<a style='cursor:pointer' onclick=GetPagesValues(" + i + ");>" + i + "  </a>";


        }
        $("#Paging").append("<u>Page:- </u>" + pages);
    }
    //setPages

    //Edit Delete
    function Edit(id) {
        location.href = "@Url.Content("~/Users/Edit/")" + id;
    }
    function Delete(id) {
        if (confirm('Do You Want To Delete This Record')) {
            $.post("@Url.Content("~/Users/Delete")", { id: id }, function (data) {
                $.post("@Url.Content("~/Users/GetUsersDetail")", null, function (data) { SetGrid(data); }, "Json");
                alert(data);
            }, "Json");
        }
    }
    //Edit Delete



    //Get Pages
    function GetPagesValues(id) {
        $.post("@Url.Content("~/Users/GetUsersDetail")", { page: id }, function (data) { SetGrid(data); }, "Json");
    }

    //Get Pages
    //State
//Get All States
    function show() {
        $.get("@Url.Content("~/state/Showstate")", null, function (data) { chk(data, "StateId"); })
            .error(function (data) { chk(data,"StateId"); });
    }
    //Check Permisson and Session
    function chk(abc, Cid) {                
        if (abc == "You do not have view permission") {

            alert("You Do Not Have View Permission");
            return false;
        }
        else {
            if (abc == "session expire") {
                location.href = '@Url.Action("login", "login")';
            }
            else if (abc == "Invalid Value") {
            alert("Invalid Value");
            }
            else {
                if (Cid == "StateId") {
                    SetDropDown(abc, Cid);
                }
                else if (Cid == "CityId") {
                    SetCityDropDown(abc, "CityId");
                }
                else if (Cid == "RoleID") {
                SetRoleDropDown(abc, "RoleID");
                }
            }
        }
    }
    // Fill State DropDown
    function SetDropDown(data,cId) {        
        option = "";
        
        var procat = $("#" + cId);
        procat.empty();
        procat.append("<option value=0>Select</option>");
        $.each(data, function (key, value) {
            option += "<option value=" + value.id + ">" + value.statename + "</option>";

        });
        procat.append(option);
    }
    //State

    //Fill City DropDown
    function SetCityDropDown(data, cId) {
        option = "";

        var procat = $("#" + cId);
        procat.empty();
        procat.append("<option value=0>Select</option>");
        $.each(data, function (key, value) {
            option += "<option value=" + value.cityname + ">" + value.cityname + "</option>";

        });
        procat.append(option);
    }
    //Fill City DropDown
    //City
    function showCity() {
        var statedValue = $("#StateId").val();
        $.get("@Url.Content("~/city/Showcity")", { id: statedValue }, function (data) { chk(data, "CityId"); })
            .error(function (data) { chk(data, "CityId"); });
    }
    //City




    function SetRoleDropDown(data, cId) {
        option = "";

        var procat = $("#" + cId);
        procat.empty();
        procat.append("<option value=0>Select</option>");
        $.each(data, function (key, value) {
            option += "<option value=" + value.id + ">" + value.name + "</option>";

        });
        procat.append(option);
    }

    //GetRole
</script>

<div id="content_wrap">
    <div class="msgbar msg_Info heading">
       Dealer/Distributor Master</div>
        @using (Html.BeginForm("Save", "Users", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
    <div class="content_main">
        <div class="boxes1">
            <table>
                <tr>
                    <td>
                        Name <span style="color: red;">*</span>
                    </td>
                    <td>
                        @Html.TextBoxFor(a => a.Dis_Name)
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_Name, "", new { @class = "required" })
                    </td>
                    <td>
                        Email <span style="color: red;">*</span>
                    </td>
                    <td>
                        @Html.TextBoxFor(a => a.Dis_Email)
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_Email, "", new { @class = "required" })
                    </td>
                </tr>
                <tr>
                    <td>
                        State <span style="color: red;">*</span>
                    </td>
                    <td>
                        <select id="StateId" name="stateName" onchange="showCity()">
                            <option value="0">Select</option>
                        </select>
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_State, "", new { @class = "required" })
                    </td>
                    <td>
                        City <span style="color: red;">*</span>
                    </td>
                    <td>
                        <select id="CityId" name="cityName">
                            <option value="0">Select</option>
                        </select>
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_City, "", new { @class = "required" })
                    </td>
                </tr>
                <tr>
                    <td>
                        District <span style="color: red;">*</span>
                    </td>
                    <td>
                        @Html.TextBoxFor(a => a.Dis_District)
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_District, "", new { @class = "required" })
                    </td>
                    <td>
                        Contact No. <span style="color: red;">*</span>
                    </td>
                    <td>
                        @Html.TextBoxFor(a => a.Dis_ContactNo)
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_ContactNo, "", new { @class = "required" })
                    </td>
                </tr>
                <tr>
                    <td>
                        Address 1 <span style="color: red;">*</span>
                    </td>
                    <td>
                        @Html.TextAreaFor(a => a.Dis_Address1)
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_Address1, "", new { @class = "required" })
                    </td>
                    <td>
                        Address 2 
                    </td>
                    <td>
                        @Html.TextAreaFor(a => a.Dis_Address2)
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_Address2, "", new { @class = "required" })
                    </td>
                </tr>
                <tr>
                    <td>
                        Profile Image <span style="color: red;">*</span>
                    </td>
                    <td>
                        @Html.TextBoxFor(a => a.ProfileImage, new { @type = "File" ,})
                        <br />
                        @Html.ValidationMessageFor(a => a.ProfileImage, "", new { @class = "required" })
                    </td>
                    <td>
                        SAP Code <span style="color: red;">*</span>
                    </td>
                    <td>
                        @Html.TextBoxFor(a => a.Dis_Sap_Code)
                        <br />
                        @Html.ValidationMessageFor(a => a.Dis_Sap_Code, "", new { @class = "required" })
                    </td>
                </tr>
                <tr>
                    <td>
                        Customer Type <span style="color: red;">*</span>
                    </td>
                    <td>
                        <select id="CustomerId" name="CustomerName">
                            <option value="0">Select</option>
                            <option value="DISTY">Destributor</option>
                            <option value="Dealer">Dealer</option>
                        </select>
                        <br />
                        @Html.ValidationMessageFor(a => a.CustomerType, "", new { @class = "required" })
                    </td>
                    <td>
                        Select Region <span style="color: red;">*</span>
                    </td>
                    <td>
                        <select id="RoleID" name="RoleName">
                            <option value="0">Select</option>
                        </select>
                        <br />
                        @Html.ValidationMessageFor(a => a.RegId, "", new { @class = "required" })
                    </td>
                </tr>
                <tr>
                    <td>
                        Is Active <span style="color: red;">*</span>
                    </td>
                    <td colspan="3">
                        <input type="checkbox" name="IsAvtiveName" checked="checked" />
                        <br />
                        @Html.ValidationMessageFor(a => a.isActive, "", new { @class = "required" })
                    </td>
                </tr>
            </table>
            <input type="submit" value="Submit" />
        </div>
    </div>
        }
</div>

<div id="list" style="width: 997px; float: right; margin-right: 15px;">
    <table id="Grid" width="100%">
        <thead>
            <tr>
                <th>
                    ID
                </th>
                <th>
                    Name
                </th>
                <th>
                  SAP Code
                </th>
                <th>
                  Customer Type
                </th>
                <th>
                    Status
                </th>
                <th>
                    Action
                </th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <div id="Paging">
    </div>
</div>

