@model Luminous.EF.Dealer
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="@Url.Content("~/assets/css/Formstyle.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/assets/js/jquery-1.10.2.js")" type="text/javascript"></script>
<script src="@Url.Content("~/assets/js/jquery-ui.min.js")" type="text/javascript"></script>
<link href="@Url.Content("~/assets/css/jquery-ui.min.css")" rel="stylesheet" type="text/css" />

<style type="text/css">
    .required
    {
        color: Red;
    }
    table
    {
        border: 0;
        border-spacing: 0;
        font-size: 0.857em;
        margin: 10px 0;
        width: 100%;
    }
    table table
    {
        font-size: 1em;
    }
    #footer-wrapper table
    {
        font-size: 1em;
    }
    table tr th
    {
        background: #757575;
        background: rgba(0, 0, 0, 0.51);
        border-bottom-style: none;
    }
    table tr th, table tr th a, table tr th a:hover
    {
        color: #FFF;
        font-weight: bold;
    }
    table tbody tr th
    {
        vertical-align: top;
    }
    tr td, tr th
    {
        padding: 4px 9px;
        border: 1px solid #fff;
        text-align: left; /* LTR */
    }
    #footer-wrapper tr td, #footer-wrapper tr th
    {
        border-color: #555;
        border-color: rgba(255, 255, 255, 0.18);
    }
    tr.odd
    {
        background: #e4e4e4;
        background: rgba(0, 0, 0, 0.105);
    }
    tr, tr.even
    {
        background: #efefef;
        background: rgba(0, 0, 0, 0.063);
    }
    table ul.links
    {
        margin: 0;
        padding: 0;
        font-size: 1em;
    }
    table ul.links li
    {
        padding: 0 1em 0 0;
    }
</style>
<script type="text/javascript">
    $(function () {
        $.post("@Url.Content("~/Destributor/GetRegions")", null, function (data) { SetProdcutCategory(data, 'ProductCategory'); },
        "Json");
        $.post("@Url.Content("~/Dealers/GetContactDetail")", null, function (data) { SetGrid(data); }, "Json");
    });
    function GetPagesValues(id) {
        $.post("@Url.Content("~/Dealers/GetContactDetail")", { page: id }, function (data) { SetGrid(data); }, "Json");
    }
    function SetGrid(data) {
        if (data == "Login") {
            location.href = "@Url.Content("~/Logout/Logout")";
        }
        else if (data == "snotallowed") {
            location.href = "@Url.Content("~/snotallowed/snotallowed")";
        }
        else {
            var body = "";
            $("#Grid tbody").empty();
            $.each(data.result, function (key, value) {
                body += "<tr><td>" + value.id + "</td>" +
            "<td>" + value.RegionName + "</td>" +
             "<td>" + value.DestriName + "</td>" +
            "<td>" + value.Name + "</td>" +
             "<td>" + value.status + "</td>" +

            "<td><a style='cursor:pointer' onclick=Edit(" + value.id + ");>Edit</a> <a style='cursor:pointer' onclick=Delete(" + value.id + ");>Delete</a></td></tr>";
                debugger;
            });
            $("#Grid tbody").append(body);
            SetPages(data.TotalRecord)
        }
    }

    function SetPages(paging) {
        var pages = "";
        $("#Paging").empty();
        $("#Paging").empty();

        for (var i = 1; i <= parseInt(paging); i++) {

            pages += "<a style='cursor:pointer' onclick=GetPagesValues(" + i + ");> " + i + "  </a>";


        }
        $("#Paging").append("<u>Page:- </u>" + pages);
    }

    function Edit(id) {
        location.href = "@Url.Content("~/Dealers/Edit/")" + id;
    }
    function Delete(id) {
        if (confirm("Do You Want To Delete This Record")) {
            $.post("@Url.Content("~/Dealers/DeleteContact")", { id: id }, function (data) {
                $.post("@Url.Content("~/Dealers/GetContactDetail")", null, function (data) { SetGrid(data); }, "Json");
                alert(data);
            }, "Json");
        }
    }
    function SetProdcutlevelOne() {
        var procat = $("#ProductCategory :selected").val();
        var procatLvlOne = $("#pclvlOne");
        $.post("@Url.Content("~/Dealers/GetDestributors")", { RegionId: procat }, function (data) { SetProdcutCategory(data, 'pclvlOne'); }, "Json");
    }

    function SetProdcutCategory(data, id) {
        if (data == "Login") {
            location.href = "@Url.Content("~/Logout/Logout")";
        }
        else if (data == "snotallowed") {
            location.href = "@Url.Content("~/snotallowed/snotallowed")";
        }
        else {
            option = "";
            var procat = $("#" + id);
            procat.empty();
            procat.append("<option value=0>Select</option>");
            $.each(data, function (key, value) {
                option += "<option value=" + value.id + ">" + value.Name + "</option>";

            });
            procat.append(option);
            if ('@ViewBag.ProductCat' != "") {

                $("#ProductCategory").val('@ViewBag.ProductCat');
            }
            if ('@ViewBag.ProductCat1' != "") {
                $("#pclvlOne").val('@ViewBag.ProductCat1');
            }
            if ('@ViewBag.ProductCat2' != "") {
                $("#pclvlTwo").val('@ViewBag.ProductCat2');
            }
        }
    }
</script>
<div id="form" style="margin-bottom: 11px">
    @using (Html.BeginForm("SaveContact","Dealers"))
    { 
        <div id="content_wrap">
            <div class="msgbar msg_Info heading">
                Dealers</div>
            <div class="content_main">
                <div class="boxes1">
                    <table id="GridView">
                        <tr>
                            <td style="width: 137px;">
                                Select Region<span class="required">*</span>
                            </td>
                            <td style="width: 221px">
                                <select name="regionst" onchange="SetProdcutlevelOne();" style="color: black" id="ProductCategory">
                                    <option>Select</option>
                                </select>
                                <br />
                                @Html.ValidationMessageFor(model => model.RegionId, "", new { @class = "required" })
                                <span id="pcIdValidation"></span>
                            </td>
                            <td style="width: 124px;">
                                Distributor<span class="required">*</span>
                            </td>
                            <td style="width: 221px">
                                <select name="Destri" style="color: black" id="pclvlOne">
                                    <option>Select</option>
                                </select>
                                <br />
                                @Html.ValidationMessageFor(model => model.DestributorId, "", new { @class = "required" })
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Dealer Name<span class="required">*</span>
                            </td>
                            <td>
                                @Html.TextBoxFor(a => a.name)
                                <br />
                                @Html.ValidationMessageFor(model => model.name, "", new { @class = "required" })
                            </td>
                            <td>
                                Status
                            </td>
                            <td>
                                <input type="checkbox" checked="checked" name="statusC" />
                            </td>
                        </tr>
                    </table>
                    <input type="submit" value="Submit" />
                </div>
            </div>
        </div>        
    }
</div>
<div id="list" style="width: 997px; float: right; margin-right: 15px;">
    <table id="Grid" width="100%">
        <thead>
            <tr>
                <th>
                    ID
                </th>
                <th>
                    Region Name
                </th>
                <th>
                    Distributor Name
                </th>
                <th>
                    Dealer Name
                </th>
                <th>
                    Status
                </th>
                <th>
                    Action
                </th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <div id="Paging">
    </div>
</div>
